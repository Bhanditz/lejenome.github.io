<!DOCTYPE html> <html lang="en" itemscope itemType="http://schema.org/TechArticle"> <head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# website: http://ogp.me/ns/website# type: http://ogp.me/ns/profile# fb: http://ogp.me/ns/fb#"> <meta charset="utf-8"> <title itemprop="name">[Syteup] creating a basic plugin, segment as an example | Moez Bouhlel</title> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <meta name="description" content="Moez Bouhlel (lejenome) website for latest updates. Hire me for a part-time job or for an internship at https://lejenome.github.io/resume"> <meta name="keywords" content="syteup,moez,bouhlel,lejenome,bmoez,bmoezj,bmoez.j" itemprop="keywords"> <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no,width=device-width,minimum-scale=1"> <meta property="author" content="Moez Bouhlel" itemprop="creator"> <meta name="copyright" content="Moez Bouhlel 2016, All Rights Reserved."> <link rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"> <base href="/"> <link rel="alternate" type="application/rss+xml" href="rss.xml"> <meta name="google-site-verification" content="S6sLGAfoubJHu5uLGJMU9sOD82LL7APn_EYSZQPOXsE"> <meta name="p:domain_verify" content="3324f7e099304fd296c47e61bc056185"> <meta property="fb:app_id" content="135239077081828"> <meta name="flattr:id" content="wlwnr0"> <link rel="openid.server" href="https://login.launchpad.net/+openid"> <link rel="openid.delegate" href="https://login.launchpad.net/+id/mBmWsYt"> <link rel="openid2.provider" href="https://login.launchpad.net/+openid"> <link rel="openid2.local_id" href="https://login.launchpad.net/+id/mBmWsYt"> <meta http-equiv="X-XRDS-Location" content="https://login.launchpad.net/+id/mBmWsYt/+xrds"> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@lejenome"> <meta name="twitter:creator" content="@lejenome"> <meta name="twitter:domain" content="lejenome.github.io"> <meta property="og:site_name" content="Moez Bouhlel"> <meta property="og:type" content="article"> <meta property="article:tag" content="syteup,"> <meta property="article:author" content="https://lejenome.github.io/resume"> <meta itemprop="inLanguage" content="en"> <meta property="og:url" itemprop="url" content="https://lejenome.github.io/post/syteup-plugin-creation"> <link rel="canonical" href="https://lejenome.github.io/post/syteup-plugin-creation"> <meta property="article:published_time" content="2014/11/04"> <meta name="twitter:description" property="og:description" itemprop="description" content="Moez Bouhlel (lejenome) Website for latest updates."> <meta name="twitter:title" property="og:title" content="[Syteup] creating a basic plugin, segment as an example | Moez Bouhlel"> <meta name="twitter:image" property="og:image" itemprop="image" content="https://lejenome.github.io/imgs/logo-350x350.jpg"> <link rel="apple-touch-icon-precomposed" sizes="57x57" href="imgs/favicon/apple-touch-icon-57x57.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="imgs/favicon/apple-touch-icon-114x114.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="imgs/favicon/apple-touch-icon-72x72.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="imgs/favicon/apple-touch-icon-144x144.png"> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="imgs/favicon/apple-touch-icon-60x60.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="imgs/favicon/apple-touch-icon-120x120.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="imgs/favicon/apple-touch-icon-76x76.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="imgs/favicon/apple-touch-icon-152x152.png"> <link rel="icon" type="image/png" href="imgs/favicon/favicon-196x196.png" sizes="196x196"> <link rel="icon" type="image/png" href="imgs/favicon/favicon-96x96.png" sizes="96x96"> <link rel="icon" type="image/png" href="imgs/favicon/favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="imgs/favicon/favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="imgs/favicon/favicon-128.png" sizes="128x128"> <meta name="msapplication-TileImage" content="imgs/favicon/mstile-144x144.png"> <meta name="msapplication-square70x70logo" content="imgs/favicon/mstile-70x70.png"> <meta name="msapplication-square150x150logo" content="imgs/favicon/mstile-150x150.png"> <meta name="msapplication-wide310x150logo" content="imgs/favicon/mstile-310x150.png"> <meta name="msapplication-square310x310logo" content="imgs/favicon/mstile-310x310.png"> <link href="css/style.css" type="text/css" rel="stylesheet"> <script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-28759938-2","auto"),ga("_trackPageLoadTime"),ga("send","pageview")</script> </head> <body class="container"> <header> <h1><a href="">Moez Bouhlel <small>@lejenome</small></a></h1> <nav> <ul class="menu"> <li><a href="">Home</a></li> <li><a href="https://twitter.com/lejenome">Twitter</a></li> <li><a href="https://github.com/lejenome">GitHub</a></li> <li><a href="https://www.linkedin.com/in/lejenome">LinkedIn</a></li> <li><a href="resume" rel="author">Resume</a></li> <li><a href="contact">Contact</a></li> </ul> <ul class="icons"> <li> <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top"> <input type="hidden" name="cmd" value="_donations"> <input type="hidden" name="business" value="lejenome@gmail.com"> <input type="hidden" name="lc" value="US"> <input type="hidden" name="item_name" value="Moez Bouhlel"> <input type="hidden" name="item_number" value="lejenome.tik.tn"> <input type="hidden" name="no_note" value="0"> <input type="hidden" name="currency_code" value="USD"> <input type="hidden" name="bn" value="PP-DonationsBF:btn_donate_SM.gif:NonHostedGuest"> <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!" style="height:18px;vertical-align:sub"> <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1"> </form> </li> <li><a rel="archives" title="Archive" href="archive"><i class="fa fa-folder-open"></i></a></li> <li><a title="RSS" rel="alternate" type="application/rss+xml" href="rss.xml"><i class="fa fa-rss"></i></a></li> </ul> </nav> </header> <div> <section id="articales" class="type-post"> <article class="post" id="syteup-plugin-creation"> <meta itemprop="proficiencyLevel" content="Beginner"> <link itemprop="publisher" href="https://lejenome.github.io/resume" rel="author"> <hgroup> <h2 class="post-title" itemprop="name" itemprop="headline"><a href="post/syteup-plugin-creation" class="post-link" itemprop="url" rel="bookmark">[Syteup] creating a basic plugin, segment as an example</a></h2> <h3 class="post-date"> <time datetime="2014/11/04" itemprop="datePublished"><i class="fa fa-clock-o"></i> Tue Nov 04 2014</time> - <a href="https://github.com/lejenome/lejenome.github.io/blob/master/posts/syteup-creating-basic-plugin-segment.md" rel="edit"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> edit</a> - <span>share </span> <ul class="post-share"> <li><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://lejenome.github.io/post/syteup-plugin-creation"><i class="fa fa-facebook-square"></i> </a></li> <li><a target="_blank" href="https://plus.google.com/share?url=https://lejenome.github.io/post/syteup-plugin-creation"><i class="fa fa-google-plus-square"></i> </a></li> <li><a target="_blank" href="https://twitter.com/intent/tweet?url=https://lejenome.github.io/post/syteup-plugin-creation&text=%5BSyteup%5D%20creating%20a%20basic%20plugin%2C%20segment%20as%20an%20example"><i class="fa fa-twitter-square"></i> </a></li> <li><a target="_blank" href="https://www.reddit.com/submit?url=https://lejenome.github.io/post/syteup-plugin-creation&title=%5BSyteup%5D%20creating%20a%20basic%20plugin%2C%20segment%20as%20an%20example"><i class="fa fa-reddit-square"></i> </a></li> <li><a target="_blank" href="https://www.tumblr.com/share/link?url=https://lejenome.github.io/post/syteup-plugin-creation&name=%5BSyteup%5D%20creating%20a%20basic%20plugin%2C%20segment%20as%20an%20example"><i class="fa fa-tumblr-square"></i> </a></li> <li><a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=https://lejenome.github.io/post/syteup-plugin-creation&title=%5BSyteup%5D%20creating%20a%20basic%20plugin%2C%20segment%20as%20an%20example"><i class="fa fa-linkedin-square"></i> </a></li> </ul> </h3> </hgroup> <div class="post-body" itemprop="articleBody"> <p>Here, we will add Segment support to Syteup.</p> <p>Segment is "a customer data hub". It makes it easy to integrate third-party tools (analytics, advertising,...) to your application throw a all-in-one single library.</p> <p>To add Segment plugin support to Syteup, we needs just 3 simple steps:</p> <p>1- create <code>plugins/segment.js</code> plugin code file that will export the plugin module to the window object:</p> <div class="code"><pre><span></span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nb">window</span><span class="p">)</span> <span class="p">{</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="kd">function</span> <span class="nx">setupSegment</span><span class="p">(</span><span class="nx">settings</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span> <span class="o">||</span> <span class="p">[];</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span><span class="p">.</span><span class="nx">methods</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;identify&quot;</span><span class="p">,</span>
            <span class="s2">&quot;group&quot;</span><span class="p">,</span>
            <span class="s2">&quot;track&quot;</span><span class="p">,</span>
            <span class="s2">&quot;page&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pageview&quot;</span><span class="p">,</span>
            <span class="s2">&quot;alias&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ready&quot;</span><span class="p">,</span>
            <span class="s2">&quot;on&quot;</span><span class="p">,</span>
            <span class="s2">&quot;once&quot;</span><span class="p">,</span>
            <span class="s2">&quot;off&quot;</span><span class="p">,</span>
            <span class="s2">&quot;trackLink&quot;</span><span class="p">,</span>
            <span class="s2">&quot;trackForm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;trackClick&quot;</span><span class="p">,</span>
            <span class="s2">&quot;trackSubmit&quot;</span>
        <span class="p">];</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span><span class="p">.</span><span class="nx">factory</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
                <span class="nx">args</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">method</span><span class="p">);</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
                <span class="k">return</span> <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span><span class="p">;</span>
            <span class="p">};</span>
        <span class="p">};</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span><span class="p">.</span><span class="nx">methods</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span><span class="p">.</span><span class="nx">methods</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span><span class="p">.</span><span class="nx">factory</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span><span class="p">.</span><span class="nx">load</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;analytics-js&quot;</span><span class="p">))</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">);</span>
            <span class="nx">script</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;text/javascript&quot;</span><span class="p">;</span>
            <span class="nx">script</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">&quot;analytics-js&quot;</span><span class="p">;</span>
            <span class="nx">script</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">script</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;https:&quot;</span> <span class="o">===</span> <span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">protocol</span> <span class="o">?</span> <span class="s2">&quot;https://&quot;</span> <span class="o">:</span> <span class="s2">&quot;http://&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;cdn.segment.com/analytics.js/v1/&quot;</span> <span class="o">+</span> <span class="nx">key</span> <span class="o">+</span> <span class="s2">&quot;/analytics.min.js&quot;</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">first</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
            <span class="nx">first</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">script</span><span class="p">,</span> <span class="nx">first</span><span class="p">);</span>
        <span class="p">};</span>
        <span class="c1">// Add a version to keep track of what&#39;s in the wild.</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span><span class="p">.</span><span class="nx">SNIPPET_VERSION</span> <span class="o">=</span> <span class="s2">&quot;2.0.9&quot;</span><span class="p">;</span>
        <span class="c1">// Load Analytics.js with your key, which will automatically</span>
        <span class="c1">// load the tools you&#39;ve enabled for your account. Boosh!</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">settings</span><span class="p">[</span><span class="s2">&quot;write_key&quot;</span><span class="p">]);</span>
        <span class="c1">// Make the first page call to load the integrations. If</span>
        <span class="c1">// you&#39;d like to manually name or tag the page, edit or</span>
        <span class="c1">// move this call however you&#39;d like.</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">analytics</span><span class="p">.</span><span class="nx">page</span><span class="p">({</span> <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Syteup&quot;</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">segmentPlugin</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">setup</span><span class="o">:</span> <span class="nx">setupSegment</span> <span class="p">};</span>
<span class="p">}(</span><span class="nb">window</span><span class="p">));</span>
</pre></div> <p>what we did is to add segment code (copied from segment tutorial) into the <code>setupSegment</code> function, then we export it as <code>setup</code> item on the plugin module which should be named <code>segmentPlugin</code>. As you note, the user depending write_key is readed from the <code>settings</code> object of the plugin which will be added on the third step.</p> <p>2- we add a script tag to the <code>index.html</code> file that will load the plugin code.</p> <p>the script tag should be included on the plugins section just before <code>js/plugins.js</code> tag and it should be loaded on defer mode</p> <div class="code"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">defer</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;plugins/segment.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div> <p>3- Finally, we add the plugin settings to the configuration file <code>config.json</code></p> <p>option to turn on/off the plugin inside the <code>plugins</code> option:</p> <div class="code"><pre><span></span><span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;segment&quot;</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">}</span>
</pre></div> <p>the plugin settings object that includes all user depending settings (here we will need the user's write_key) on the <code>plugins_settings option</code>:</p> <div class="code"><pre><span></span><span class="s2">&quot;plugins_settings&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;segment&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;write_key&quot;</span><span class="o">:</span> <span class="s2">&quot;?????????&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div> <p>All Done! we are ready to test our plugin.</p> <p>Don't be lazy, and send me a pull request with your plugins code and other patches to <a href="https://github.com/lejenome/syteup">https://github.com/lejenome/syteup</a> !</p> </div> <script>function disqus_config(){this.page.url="https://lejenome.github.io/post/syteup-plugin-creation",this.page.identifier="syteup-plugin-creation",this.page.title="[Syteup] creating a basic plugin, segment as an example"}</script> <div class="post-comments post-comment-thread" id="disqus_thread"></div> </article> </section> <nav id="posts-nav"> <ul><li><a href="post/python-101-training-get-ready" rel="next" id="prev-post">Newer</a></li> <li><a href="post/syteup-introduction" rel="prev" id="next-post">Older</a></li> </ul> </nav> </div> <script>function linenumber(n){var l;for(l=0;l<n.length;l++){var e=n[l].innerHTML;e='<ol class="linenums"><li><span class="codeline">'+e.split("\n").slice(0,-1).join('</span></li><li><span class="codeline">')+"</span></li></ol>",n[l].innerHTML=e}}linenumber(document.querySelectorAll(".code pre"))</script> <noscript id="deferred-styles"> <link rel="stylesheet" type="text/css" href="css/font-awesome.css"> <link rel="stylesheet" type="text/css" href="css/source-code-pro.css"> <link rel="stylesheet" type="text/css" href="css/pygmentize.default.css"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i,900,900i"> </noscript> <script>var loadDeferredStyles=function(){var e=document.getElementById("deferred-styles"),t=document.createElement("div");t.innerHTML=e.textContent,document.body.appendChild(t),e.parentElement.removeChild(e)},raf=requestAnimationFrame||mozRequestAnimationFrame||webkitRequestAnimationFrame||msRequestAnimationFrame;raf?raf(function(){window.setTimeout(loadDeferredStyles,0)}):window.addEventListener("load",loadDeferredStyles)</script> <script type="text/javascript">var _paq=_paq||[];_paq.push(["enableHeartBeatTimer"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){var e="https://api.admin.tik.tn/p";_paq.push(["setTrackerUrl",e]),_paq.push(["setSiteId",1]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.defer=!0,t.src=e,p.parentNode.insertBefore(t,p)}()</script> <script src="https://lejenome.disqus.com/embed.js" defer="defer"></script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-2482029926365022" data-ad-slot="6455608003" data-ad-format="auto"></ins> <script>(adsbygoogle=window.adsbygoogle||[]).push({})</script> </body> </html>